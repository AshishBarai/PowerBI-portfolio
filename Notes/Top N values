How to calculate dynamically top "N" values

